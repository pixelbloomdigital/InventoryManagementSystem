spring.application.name=api-gateway
server.port=8080
eureka.client.service-url.defaultZone=http://localhost:8761/eureka
eureka.instance.prefer-ip-address=true
eureka.instance.ip-address=127.0.0.1

# --------------------------
# Admin-only routes
# --------------------------
spring.cloud.gateway.routes[0].id=admin-orders
spring.cloud.gateway.routes[0].uri=http://localhost:9095
spring.cloud.gateway.routes[0].predicates[0]=Path=/api/auth/admin/orders/**
spring.cloud.gateway.routes[0].filters[0]=JwtAuthenticationFilter
spring.cloud.gateway.routes[0].filters[1]=RoleBasedFilter
spring.cloud.gateway.routes[0].filters[2]=RewritePath=/api/auth/admin/orders/(?<segment>.*), /api/orders/${segment}

spring.cloud.gateway.routes[1].id=admin-inventory
spring.cloud.gateway.routes[1].uri=http://localhost:9093
spring.cloud.gateway.routes[1].predicates[0]=Path=/api/auth/admin/inventory/**
spring.cloud.gateway.routes[1].filters[0]=JwtAuthenticationFilter
spring.cloud.gateway.routes[1].filters[1]=RoleBasedFilter
spring.cloud.gateway.routes[1].filters[2]=RewritePath=/api/auth/admin/inventory/(?<segment>.*), /api/inventory/${segment}

spring.cloud.gateway.routes[2].id=admin-customers
spring.cloud.gateway.routes[2].uri=http://localhost:9095
spring.cloud.gateway.routes[2].predicates[0]=Path=/api/auth/admin/customers/**
spring.cloud.gateway.routes[2].filters[0]=JwtAuthenticationFilter
spring.cloud.gateway.routes[2].filters[1]=RoleBasedFilter
spring.cloud.gateway.routes[2].filters[2]=RewritePath=/api/auth/admin/customers/(?<segment>.*), /api/customers/${segment}

spring.cloud.gateway.routes[3].id=admin-shipping
spring.cloud.gateway.routes[3].uri=http://localhost:9097
spring.cloud.gateway.routes[3].predicates[0]=Path=/api/auth/admin/shipping/**
spring.cloud.gateway.routes[3].filters[0]=JwtAuthenticationFilter
spring.cloud.gateway.routes[3].filters[1]=RoleBasedFilter
spring.cloud.gateway.routes[3].filters[2]=RewritePath=/api/auth/admin/shipping/(?<segment>.*), /api/shipping/${segment}

# --------------------------
# All other routes (USER + ADMIN)
# --------------------------
spring.cloud.gateway.routes[4].id=user-access
spring.cloud.gateway.routes[4].uri=http://localhost:9095
spring.cloud.gateway.routes[4].predicates[0]=Path=/api/auth/user/**,/api/order/**,/api/customers/**
spring.cloud.gateway.routes[4].filters[0]=JwtAuthenticationFilter
spring.cloud.gateway.routes[4].filters[1]=RoleBasedFilter
spring.cloud.gateway.routes[4].filters[2]=RewritePath=/api/auth/user/(?<segment>.*), /api/${segment}

spring.cloud.gateway.routes[5].id=user-inventory
spring.cloud.gateway.routes[5].uri=http://localhost:9093
spring.cloud.gateway.routes[5].predicates[0]=Path=/api/auth/user/inventory/**
spring.cloud.gateway.routes[5].filters[0]=JwtAuthenticationFilter
spring.cloud.gateway.routes[5].filters[1]=RoleBasedFilter
spring.cloud.gateway.routes[5].filters[2]=RewritePath=/api/auth/user/inventory/(?<segment>.*), /api/inventory/${segment}

spring.cloud.gateway.routes[6].id=user-shipping
spring.cloud.gateway.routes[6].uri=http://localhost:9097
spring.cloud.gateway.routes[6].predicates[0]=Path=/api/auth/user/shipping/**
spring.cloud.gateway.routes[6].filters[0]=JwtAuthenticationFilter
spring.cloud.gateway.routes[6].filters[1]=RoleBasedFilter
spring.cloud.gateway.routes[6].filters[2]=RewritePath=/api/auth/user/shipping/(?<segment>.*), /api/shipping/${segment}

# --------------------------
# Auth service (login/register)
# --------------------------
spring.cloud.gateway.routes[7].id=auth-service
spring.cloud.gateway.routes[7].uri=http://localhost:2000
spring.cloud.gateway.routes[7].predicates[0]=Path=/api/auth/register,/api/auth/login,/api/auth/customer/**

# --------------------------
# Internal Inventory Service
# --------------------------
spring.cloud.gateway.routes[8].id=internal-inventory
spring.cloud.gateway.routes[8].uri=http://localhost:9093
spring.cloud.gateway.routes[8].predicates[0]=Path=/api/inventory/**
spring.cloud.gateway.routes[8].filters[0]=JwtAuthenticationFilter

# --------------------------
# Direct Shipping Service (for testing)
# --------------------------
spring.cloud.gateway.routes[9].id=direct-shipping
spring.cloud.gateway.routes[9].uri=http://localhost:9097
spring.cloud.gateway.routes[9].predicates[0]=Path=/api/shipping/**
